<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/csharp/blog/rss.xml" title="Playwright Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/csharp/blog/atom.xml" title="Playwright Blog Atom Feed">
<script src="js/redirection.js"></script><title data-react-helmet="true">Continuous Integration | Playwright</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Continuous Integration | Playwright"><meta data-react-helmet="true" name="description" content="Playwright tests can be executed in CI environments. We have created sample configurations for common CI providers."><meta data-react-helmet="true" property="og:description" content="Playwright tests can be executed in CI environments. We have created sample configurations for common CI providers."><meta data-react-helmet="true" property="og:url" content="https://playwright.dev/csharp/docs/ci"><link data-react-helmet="true" rel="shortcut icon" href="/csharp/img/playwright-logo.svg"><link data-react-helmet="true" rel="canonical" href="https://playwright.dev/csharp/docs/ci"><link rel="stylesheet" href="/csharp/styles.79c856c9.css">
<link rel="preload" href="/csharp/styles.32d5af45.js" as="script">
<link rel="preload" href="/csharp/runtime~main.194e3cd4.js" as="script">
<link rel="preload" href="/csharp/main.a5ad5540.js" as="script">
<link rel="preload" href="/csharp/1.d2f3c36b.js" as="script">
<link rel="preload" href="/csharp/2.300e1058.js" as="script">
<link rel="preload" href="/csharp/01a85c17.af98a75d.js" as="script">
<link rel="preload" href="/csharp/1a4e3797.f5652084.js" as="script">
<link rel="preload" href="/csharp/1be78505.f8d47235.js" as="script">
<link rel="preload" href="/csharp/1df93b7f.e345a7d0.js" as="script">
<link rel="preload" href="/csharp/6875c492.cb1bd08a.js" as="script">
<link rel="preload" href="/csharp/a6aa9e1f.0ac86e98.js" as="script">
<link rel="preload" href="/csharp/ccc49370.553cdae8.js" as="script">
<link rel="preload" href="/csharp/fa17a3e5.6ac0ec5c.js" as="script">
<link rel="preload" href="/csharp/82.72c062f9.js" as="script">
<link rel="preload" href="/csharp/935f2afb.59cdbc8c.js" as="script">
<link rel="preload" href="/csharp/17896441.2cdb1718.js" as="script">
<link rel="preload" href="/csharp/19b6c1b1.acead778.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/csharp/"><img src="/csharp/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/csharp/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Playwright for C#</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/csharp/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/csharp/docs/api/class-playwright">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/playwright" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search searchBarContainer_rXwm"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_108q searchBarLoadingRing_2M8r"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/csharp/"><img src="/csharp/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/csharp/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Playwright for C#</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/csharp/docs/intro">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/csharp/docs/api/class-playwright">API</a></li><li class="menu__list-item"><a href="https://github.com/microsoft/playwright" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/why-playwright">Why Playwright?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/intro">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/core-concepts">Core concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/debug">Debugging tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/languages">Supported languages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/release-notes">Release notes</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/actionability">Auto-waiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/assertions">Assertions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/auth">Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/browsers">Browsers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/dialogs">Dialogs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/downloads">Downloads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/selectors">Element selectors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/emulation">Emulation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/extensibility">Extensibility</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/input">Input</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/inspector">Inspector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/multi-pages">Multi-page scenarios</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/navigations">Navigations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/network">Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/pom">Page Object Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/verification">Verification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/videos">Videos</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Integrations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/docker">Docker</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/csharp/docs/ci">Continuous Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/docs/cli">Command Line Interface</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Continuous Integration</h1></header><div class="markdown"><p>Playwright tests can be executed in CI environments. We have created sample configurations for common CI providers.</p><ul><li><a href="#introduction">Introduction</a></li><li><a href="#ci-configurations">CI configurations</a></li><li><a href="#caching-browsers">Caching browsers</a></li><li><a href="#debugging-browser-launches">Debugging browser launches</a></li><li><a href="#running-headed">Running headed</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>3 steps to get your tests running on CI:</p><ol><li><strong>Ensure CI agent can run browsers</strong>: Use <a href="/csharp/docs/docker">our Docker image</a> in Linux agents. Windows and macOS agents do not require any additional dependencies.</li><li><strong>Install Playwright</strong>:</li><li><strong>Run your tests</strong>:</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ci-configurations"></a>CI configurations<a class="hash-link" href="#ci-configurations" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="github-actions"></a>GitHub Actions<a class="hash-link" href="#github-actions" title="Direct link to heading">#</a></h3><p>The <a href="https://github.com/microsoft/playwright-github-action" target="_blank" rel="noopener noreferrer">Playwright GitHub Action</a> can be used to run Playwright tests on GitHub Actions.</p><p>We run <a href="https://github.com/microsoft/playwright/blob/master/.github/workflows/tests.yml" target="_blank" rel="noopener noreferrer">our tests</a> on GitHub Actions, across a matrix of 3 platforms (Windows, Linux, macOS) and 3 browsers (Chromium, Firefox, WebKit).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="docker"></a>Docker<a class="hash-link" href="#docker" title="Direct link to heading">#</a></h3><p>We have a <a href="/csharp/docs/docker">pre-built Docker image</a> which can either be used directly, or as a reference to update your existing Docker definitions.</p><p>Suggested configuration</p><ol><li><p>By default, Docker runs a container with a <code>/dev/shm</code> shared memory space 64MB. This is <a href="https://github.com/c0b/chrome-in-docker/issues/1" target="_blank" rel="noopener noreferrer">typically too small</a> for Chromium and will cause Chromium to crash when rendering large pages. To fix, run the container with <code>docker run --shm-size=1gb</code> to increase the size of <code>/dev/shm</code>. Since Chromium 65, this is no longer necessary. Instead, launch the browser with the <code>--disable-dev-shm-usage</code> flag:</p><p>This will write shared memory files into <code>/tmp</code> instead of <code>/dev/shm</code>. See <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=736452" target="_blank" rel="noopener noreferrer">crbug.com/736452</a> for more details.</p></li><li><p>Using <code>--ipc=host</code> is also recommended when using Chromiumâ€”without it Chromium can run out of memory and crash. Learn more about this option in <a href="https://docs.docker.com/engine/reference/run/#ipc-settings---ipc" target="_blank" rel="noopener noreferrer">Docker docs</a>.</p></li><li><p>Seeing other weird errors when launching Chromium? Try running your container with <code>docker run --cap-add=SYS_ADMIN</code> when developing locally.</p></li><li><p><a href="https://github.com/Yelp/dumb-init" target="_blank" rel="noopener noreferrer">dumb-init</a> is worth checking out if you&#x27;re experiencing a lot of zombies Chromium processes sticking around. There&#x27;s special treatment for processes with PID=1, which makes it hard to terminate Chromium properly in some cases (e.g. in Docker).</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="azure-pipelines"></a>Azure Pipelines<a class="hash-link" href="#azure-pipelines" title="Direct link to heading">#</a></h3><p>For Windows or macOS agents, no additional configuration required, just install Playwright and run your tests.</p><p>For Linux agents, you can use <a href="/csharp/docs/docker">our Docker container</a> with Azure Pipelines support for <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/process/container-phases?view=azure-devops" target="_blank" rel="noopener noreferrer">running containerized jobs</a>. Alternatively, you can refer to the <a href="/csharp/docs/docker">Dockerfile</a> to see additional dependencies that need to be installed on a Ubuntu agent.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">pool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">vmImage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ubuntu-20.04&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">container</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mcr.microsoft.com/playwright</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">focal</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="travis-ci"></a>Travis CI<a class="hash-link" href="#travis-ci" title="Direct link to heading">#</a></h3><p>Suggested configuration</p><ol><li><a href="http://man7.org/linux/man-pages/man7/user_namespaces.7.html" target="_blank" rel="noopener noreferrer">User namespace cloning</a> should be enabled to support proper sandboxing</li><li><a href="https://en.wikipedia.org/wiki/Xvfb" target="_blank" rel="noopener noreferrer">xvfb</a> should be launched in order to run Chromium in non-headless mode (e.g. to test Chrome Extensions)</li><li>If your project does not have <code>package-lock.json</code>, Travis would be auto-caching <code>node_modules</code> directory. If you run <code>npm install</code> (instead of <code>npm ci</code>), it is possible that the browser binaries are not downloaded. Fix this with <a href="#exception-node_modules-are-cached">these steps</a> outlined below.</li></ol><p>To sum up, your <code>.travis.yml</code> might look like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">language</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> node_js</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">dist</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> bionic</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">addons</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">apt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">packages</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># These are required to run webkit</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libwoff1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libopus0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libwebp6</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libwebpdemux2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libenchant1c2a</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libgudev</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libsecret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libhyphen0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libgdk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">pixbuf2.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libegl1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libgles2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libevent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">6</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libnotify4</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libxslt1.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libvpx5</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># gstreamer and plugins to support video playback in WebKit.</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> gstreamer1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">gl</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> gstreamer1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">base</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> gstreamer1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">good</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> gstreamer1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">bad</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># This is required to run chromium</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> libgbm1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># this is needed for running headed tests</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> xvfb</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># allow headed tests</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">before_install</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Enable user namespace cloning</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sysctl kernel.unprivileged_userns_clone=1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Launch XVFB</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;export DISPLAY=:99.0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sh -e /etc/init.d/xvfb start&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="circleci"></a>CircleCI<a class="hash-link" href="#circleci" title="Direct link to heading">#</a></h3><p>Running Playwright on CircleCI requires the following steps:</p><ol><li><p>Use the pre-built <a href="/csharp/docs/docker">Docker image</a> in your config like so:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">docker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mcr.microsoft.com/playwright</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">focal</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">NODE_ENV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> development </span><span class="token comment" style="color:rgb(98, 114, 164)"># Needed if playwright is in `devDependencies`</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li><li><p>If youâ€™re using Playwright through Jest, then you may encounter an error spawning child processes:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">[00:00.0]  jest args: --e2e --spec --max-workers=36</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Error: spawn ENOMEM</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   at ChildProcess.spawn (internal/child_process.js:394:11)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This is likely caused by Jest autodetecting the number of processes on the entire machine (<code>36</code>) rather than the number allowed to your container (<code>2</code>). To fix this, set <code>jest --maxWorkers=2</code> in your test command.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="jenkins"></a>Jenkins<a class="hash-link" href="#jenkins" title="Direct link to heading">#</a></h3><p>Jenkins supports Docker agents for pipelines. Use the <a href="/csharp/docs/docker">Playwright Docker image</a> to run tests on Jenkins.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-groovy codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">pipeline {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   agent { docker { image &#x27;mcr.microsoft.com/playwright:focal&#x27; } }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   stages {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      stage(&#x27;e2e-tests&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            sh &#x27;npm install&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            sh &#x27;npm run test&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="bitbucket-pipelines"></a>Bitbucket Pipelines<a class="hash-link" href="#bitbucket-pipelines" title="Direct link to heading">#</a></h3><p>Bitbucket Pipelines can use public <a href="https://confluence.atlassian.com/bitbucket/use-docker-images-as-build-environments-792298897.html" target="_blank" rel="noopener noreferrer">Docker images as build environments</a>. To run Playwright tests on Bitbucket, use our public Docker image (<a href="/csharp/docs/docker">see Dockerfile</a>).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mcr.microsoft.com/playwright</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">focal</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>While the Docker image supports sandboxing for Chromium, it does not work in the Bitbucket Pipelines environment. To launch Chromium on Bitbucket Pipelines, use the <code>chromiumSandbox: false</code> launch argument.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="gitlab-ci"></a>GitLab CI<a class="hash-link" href="#gitlab-ci" title="Direct link to heading">#</a></h3><p>To run Playwright tests on GitLab, use our public Docker image (<a href="/csharp/docs/docker">see Dockerfile</a>).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">stages</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> test</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">tests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">stage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> test</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mcr.microsoft.com/playwright</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">focal</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">script</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="caching-browsers"></a>Caching browsers<a class="hash-link" href="#caching-browsers" title="Direct link to heading">#</a></h2><p>By default, Playwright downloads browser binaries when the Playwright NPM package is installed. The NPM packages have a <code>postinstall</code> hook that downloads the browser binaries. This behavior can be <a href="/csharp/docs/installation">customized with environment variables</a>.</p><p>Caching browsers on CI is <strong>strictly optional</strong>: The <code>postinstall</code> hooks should execute and download the browser binaries on every run.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="exception-node_modules-are-cached-node-specific"></a>Exception: <code>node_modules</code> are cached (Node-specific)<a class="hash-link" href="#exception-node_modules-are-cached-node-specific" title="Direct link to heading">#</a></h4><p>Most CI providers cache the <a href="https://docs.npmjs.com/cli-commands/cache.html" target="_blank" rel="noopener noreferrer">npm-cache</a> directory (located at <code>$HOME/.npm</code>). If your CI pipelines caches the <code>node_modules</code> directory and you run <code>npm install</code> (instead of <code>npm ci</code>), the default configuration</p><p><strong>will not work</strong>. This is because the <code>npm install</code> step will find the Playwright NPM package on disk and not execute the <code>postinstall</code> step.</p><blockquote><p>Travis CI automatically caches <code>node_modules</code> if your repo does not have a <code>package-lock.json</code> file.</p></blockquote><p>This behavior can be fixed with one of the following approaches:</p><ol><li>Move to caching <code>$HOME/.npm</code> or the npm-cache directory. (This is the default behavior in most CI providers.)</li><li>Set <code>PLAYWRIGHT_BROWSERS_PATH=0</code> as the environment variable before running <code>npm install</code>. This will download the browser binaries in the <code>node_modules</code> directory and cache them with the package code. See <a href="/csharp/docs/installation">installation docs</a>.</li><li>Use <code>npm ci</code> (instead of <code>npm install</code>) which forces a clean install: by removing the existing <code>node_modules</code> directory. See <a href="https://docs.npmjs.com/cli/ci.html" target="_blank" rel="noopener noreferrer">npm docs</a>.</li><li>Cache the browser binaries, with the steps below.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="directories-to-cache"></a>Directories to cache<a class="hash-link" href="#directories-to-cache" title="Direct link to heading">#</a></h4><p>With the default behavior, Playwright downloads the browser binaries in the following directories:</p><ul><li><code>%USERPROFILE%\AppData\Local\ms-playwright</code> on Windows</li><li><code>~/Library/Caches/ms-playwright</code> on MacOS</li><li><code>~/.cache/ms-playwright</code> on Linux</li></ul><p>To cache the browser downloads between CI runs, cache this location in your CI configuration, against a hash of the Playwright version.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="debugging-browser-launches"></a>Debugging browser launches<a class="hash-link" href="#debugging-browser-launches" title="Direct link to heading">#</a></h2><p>Playwright supports the <code>DEBUG</code> environment variable to output debug logs during execution. Setting it to <code>pw:browser*</code> is helpful while debugging <code>Error: Failed to launch browser</code> errors.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="running-headed"></a>Running headed<a class="hash-link" href="#running-headed" title="Direct link to heading">#</a></h2><p>By default, Playwright launches browsers in headless mode. This can be changed by passing a flag when the browser is launched.</p><p>On Linux agents, headed execution requires <a href="https://en.wikipedia.org/wiki/Xvfb" target="_blank" rel="noopener noreferrer">Xvfb</a> to be installed. Our <a href="/csharp/docs/docker">Docker image</a> and GitHub Action have Xvfb pre-installed. To run browsers in headed mode with Xvfb, add <code>xvfb-run</code> before the Node.js command.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/csharp/docs/docker"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Docker</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/csharp/docs/cli"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Command Line Interface Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#ci-configurations" class="table-of-contents__link">CI configurations</a><ul><li><a href="#github-actions" class="table-of-contents__link">GitHub Actions</a></li><li><a href="#docker" class="table-of-contents__link">Docker</a></li><li><a href="#azure-pipelines" class="table-of-contents__link">Azure Pipelines</a></li><li><a href="#travis-ci" class="table-of-contents__link">Travis CI</a></li><li><a href="#circleci" class="table-of-contents__link">CircleCI</a></li><li><a href="#jenkins" class="table-of-contents__link">Jenkins</a></li><li><a href="#bitbucket-pipelines" class="table-of-contents__link">Bitbucket Pipelines</a></li><li><a href="#gitlab-ci" class="table-of-contents__link">GitLab CI</a></li></ul></li><li><a href="#caching-browsers" class="table-of-contents__link">Caching browsers</a></li><li><a href="#debugging-browser-launches" class="table-of-contents__link">Debugging browser launches</a></li><li><a href="#running-headed" class="table-of-contents__link">Running headed</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/csharp/docs/intro">Getting started</a></li><li class="footer__item"><a class="footer__link-item" href="/csharp/docs/api/class-playwright">API reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/playwright" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://aka.ms/playwright-slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/playwrightweb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/microsoft/playwright-sharp" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Microsoft</div></div></div></footer></div>
<script src="/csharp/styles.32d5af45.js"></script>
<script src="/csharp/runtime~main.194e3cd4.js"></script>
<script src="/csharp/main.a5ad5540.js"></script>
<script src="/csharp/1.d2f3c36b.js"></script>
<script src="/csharp/2.300e1058.js"></script>
<script src="/csharp/01a85c17.af98a75d.js"></script>
<script src="/csharp/1a4e3797.f5652084.js"></script>
<script src="/csharp/1be78505.f8d47235.js"></script>
<script src="/csharp/1df93b7f.e345a7d0.js"></script>
<script src="/csharp/6875c492.cb1bd08a.js"></script>
<script src="/csharp/a6aa9e1f.0ac86e98.js"></script>
<script src="/csharp/ccc49370.553cdae8.js"></script>
<script src="/csharp/fa17a3e5.6ac0ec5c.js"></script>
<script src="/csharp/82.72c062f9.js"></script>
<script src="/csharp/935f2afb.59cdbc8c.js"></script>
<script src="/csharp/17896441.2cdb1718.js"></script>
<script src="/csharp/19b6c1b1.acead778.js"></script>
</body>
</html>