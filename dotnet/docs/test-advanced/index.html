<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/dotnet/blog/rss.xml" title="Playwright Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dotnet/blog/atom.xml" title="Playwright Blog Atom Feed">
<script src="/dotnet/js/redirection.js"></script><title data-react-helmet="true">Advanced: configuration | Playwright</title><meta data-react-helmet="true" property="og:url" content="https://playwright.dev/dotnet/docs/test-advanced"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Advanced: configuration | Playwright"><meta data-react-helmet="true" name="description" content="- Configuration object"><meta data-react-helmet="true" property="og:description" content="- Configuration object"><link data-react-helmet="true" rel="shortcut icon" href="/dotnet/img/playwright-logo.svg"><link data-react-helmet="true" rel="canonical" href="https://playwright.dev/dotnet/docs/test-advanced"><link data-react-helmet="true" rel="alternate" href="https://playwright.dev/dotnet/docs/test-advanced" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://playwright.dev/dotnet/docs/test-advanced" hreflang="x-default"><link rel="stylesheet" href="/dotnet/assets/css/styles.a56bfd42.css">
<link rel="preload" href="/dotnet/assets/js/runtime~main.af00df28.js" as="script">
<link rel="preload" href="/dotnet/assets/js/main.8cd6fcf1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dotnet/"><img src="/dotnet/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/dotnet/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Playwright for .NET</strong></a><a class="navbar__item navbar__link" href="/dotnet/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/dotnet/docs/api/class-playwright">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/playwright" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_2P1H"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_3atr searchBarLoadingRing_1FtX"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/dotnet/"><img src="/dotnet/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/dotnet/img/playwright-logo.svg" alt="Playwright logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Playwright for .NET</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/dotnet/docs/intro">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/dotnet/docs/api/class-playwright">API</a></li><li class="menu__list-item"><a href="https://github.com/microsoft/playwright" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Advanced: configuration</h1></header><div class="markdown"><ul><li><a href="#configuration-object">Configuration object</a></li><li><a href="#workerinfo-object">workerInfo object</a></li><li><a href="#testinfo-object">testInfo object</a></li><li><a href="#global-setup-and-teardown">Global setup and teardown</a></li><li><a href="#projects">Projects</a></li><li><a href="#add-custom-matchers-using-expectextend">Add custom matchers using expect.extend</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuration-object"></a>Configuration object<a class="hash-link" href="#configuration-object" title="Direct link to heading">#</a></h2><p>Configuration file exports a single object.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="test-suite-options"></a>Test suite options<a class="hash-link" href="#test-suite-options" title="Direct link to heading">#</a></h3><p>These options define your test suite:</p><ul><li><code>metadata: any</code> - Any JSON-serializable metadata that will be put directly to the test report.</li><li><code>name: string</code> - Project name, useful when defining multiple <a href="#projects">test projects</a>.</li><li><code>outputDir: string</code> - Output directory for files created during the test run.</li><li><code>repeatEach: number</code> - The number of times to repeat each test, useful for debugging flaky tests.</li><li><code>retries: number</code> - The maximum number of retry attempts given to failed tests.</li><li><code>testDir: string</code> - Directory that will be recursively scanned for test files.</li><li><code>testIgnore: string | RegExp | (string | RegExp)[]</code> - Files matching one of these patterns are not considered test files.</li><li><code>testMatch: string | RegExp | (string | RegExp)[]</code> - Only the files matching one of these patterns are considered test files.</li><li><code>timeout: number</code> - Timeout for each test in milliseconds.</li><li><code>use</code> - An object defining fixture options.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="test-run-options"></a>Test run options<a class="hash-link" href="#test-run-options" title="Direct link to heading">#</a></h3><p>These options would be typically different between local development and CI operation:</p><ul><li><code>forbidOnly: boolean</code> - Whether to exit with an error if any tests are marked as <code>test.only</code>. Useful on CI.</li><li><code>globalSetup: string</code> - Path to the <a href="#global-setup-and-teardown">global setup</a> file. This file will be required and run before all the tests. It must export a single function.</li><li><code>globalTeardown: string</code> - Path to the <a href="#global-setup-and-teardown">global teardown</a> file. This file will be required and run after all the tests. It must export a single function.</li><li><code>globalTimeout: number</code> - Total timeout in milliseconds for the whole test run.</li><li><code>grep: RegExp | RegExp[]</code> - Patterns to filter tests based on their title.</li><li><code>maxFailures: number</code> - The maximum number of test failures for this test run. After reaching this number, testing will stop and exit with an error. Setting to zero (default) disables this behavior.</li><li><code>preserveOutput: &#x27;always&#x27; | &#x27;never&#x27; | &#x27;failures-only&#x27;</code> - Whether to preserve test output in the <code>outputDir</code>:<ul><li><code>&#x27;always&#x27;</code> - preserve output for all tests;</li><li><code>&#x27;never&#x27;</code> - do not preserve output for any tests;</li><li><code>&#x27;failures-only&#x27;</code> - only preserve output for failed tests.</li></ul></li><li><code>projects: Project[]</code> - Multiple <a href="#projects">projects</a> configuration.</li><li><code>reporter: &#x27;list&#x27; | &#x27;line&#x27; | &#x27;dot&#x27; | &#x27;json&#x27; | &#x27;junit&#x27;</code> - The reporter to use. See <a href="/dotnet/docs/test-reporters">reporters</a> for details.</li><li><code>quiet: boolean</code> - Whether to suppress stdout and stderr from the tests.</li><li><code>shard: { total: number, current: number } | null</code> - <a href="/dotnet/docs/test-parallel#shards">Shard</a> information.</li><li><code>updateSnapshots: boolean</code> - Whether to update expected snapshots with the actual results produced by the test run.</li><li><code>workers: number</code> - The maximum number of concurrent worker processes to use for parallelizing tests.</li></ul><p>Note that each <a href="#projects">test project</a> can provide its own test suite options, for example two projects can run different tests by providing different <code>testDir</code>s. However, test run options are shared between all projects.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="workerinfo-object"></a>workerInfo object<a class="hash-link" href="#workerinfo-object" title="Direct link to heading">#</a></h2><p>Depending on the configuration and failures, Playwright Test might use different number of worker processes to run all the tests. For example, Playwright Test will always start a new worker process after a failing test.</p><p>Worker-scoped fixtures and <code>beforeAll</code> and <code>afterAll</code> hooks receive <code>workerInfo</code> parameter. The following information is accessible from the <code>workerInfo</code>:</p><ul><li><code>config</code> - <a href="#configuration-object">Configuration object</a>.</li><li><code>project</code> - Specific <a href="#projects">project</a> configuration for this worker. Different projects are always run in separate processes.</li><li><code>workerIndex: number</code> - A unique sequential index assigned to the worker process.</li></ul><p>Consider an example where we run a new http server per worker process, and use <code>workerIndex</code> to produce a unique port number:</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testinfo-object"></a>testInfo object<a class="hash-link" href="#testinfo-object" title="Direct link to heading">#</a></h2><p>Test fixtures and <code>beforeEach</code> and <code>afterEach</code> hooks receive <code>testInfo</code> parameter. It is also available to the test function as a second parameter.</p><p>In addition to everything from the <a href="#workerinfo"><code>workerInfo</code></a>, the following information is accessible before and during the test:</p><ul><li><code>title: string</code> - Test title.</li><li><code>file: string</code> - Full path to the test file.</li><li><code>line: number</code> - Line number of the test declaration.</li><li><code>column: number</code> - Column number of the test declaration.</li><li><code>fn: Function</code> - Test body function.</li><li><code>repeatEachIndex: number</code> - The sequential repeat index.</li><li><code>retry: number</code> - The sequential number of the test retry (zero means first run).</li><li><code>expectedStatus: &#x27;passed&#x27; | &#x27;failed&#x27; | &#x27;timedOut&#x27;</code> - Whether this test is expected to pass, fail or timeout.</li><li><code>timeout: number</code> - Test timeout.</li><li><code>annotations</code> - <a href="/dotnet/docs/test-annotations">Annotations</a> that were added to the test.</li><li><code>snapshotSuffix: string</code> - Suffix used to locate snapshots for the test.</li><li><code>snapshotPath(snapshotName: string)</code> - Function that returns the full path to a particular snapshot for the test.</li><li><code>outputDir: string</code> - Absolute path to the output directory for this test run.</li><li><code>outputPath(...pathSegments: string[])</code> - Function that returns the full path to a particular output artifact for the test.</li></ul><p>The following information is accessible after the test body has finished, in fixture teardown:</p><ul><li><code>duration: number</code> - test running time in milliseconds.</li><li><code>status: &#x27;passed&#x27; | &#x27;failed&#x27; | &#x27;timedOut&#x27;</code> - the actual test result.</li><li><code>error</code> - any error thrown by the test body.</li><li><code>stdout: (string | Buffer)[]</code> - array of stdout chunks collected during the test run.</li><li><code>stderr: (string | Buffer)[]</code> - array of stderr chunks collected during the test run.</li></ul><p>Here is an example test that saves some information:</p><p>Here is an example fixture that automatically saves debug logs when the test fails:</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="global-setup-and-teardown"></a>Global setup and teardown<a class="hash-link" href="#global-setup-and-teardown" title="Direct link to heading">#</a></h2><p>To set something up once before running all tests, use <code>globalSetup</code> option in the <a href="#configuration-object">configuration file</a>.</p><p>Similarly, use <code>globalTeardown</code> to run something once after all the tests. Alternatively, let <code>globalSetup</code> return a function that will be used as a global teardown.</p><p>Here is a global setup example that runs an app.</p><p>Now add <code>globalSetup</code> option to the configuration file.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="projects"></a>Projects<a class="hash-link" href="#projects" title="Direct link to heading">#</a></h2><p>Playwright Test supports running multiple test projects at the same time. This is useful for running the same tests in multiple configurations. For example, consider running tests against multiple versions of some REST backend.</p><p>To make use of this feature, we will declare an &quot;option fixture&quot; for the backend version, and use it in the tests.</p><p>We can use our fixtures in the test.</p><p>Now, we can run test in multiple configurations by using projects.</p><p>Each project can be configured separately, and run different set of tests with different parameters. See <a href="#test-suite-options">test suite options</a> for the list of options available to each project.</p><p>You can run all projects or just a single one:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Run both projects - each test will be run twice</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">npx playwright </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run a single project - each test will be run once</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">npx playwright </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> --project</span><span class="token operator">=</span><span class="token plain">v2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="add-custom-matchers-using-expectextend"></a>Add custom matchers using expect.extend<a class="hash-link" href="#add-custom-matchers-using-expectextend" title="Direct link to heading">#</a></h2><p>Playwright Test uses <a href="https://jestjs.io/docs/expect" target="_blank" rel="noopener noreferrer"><code>expect</code> library</a> under the hood which has the functionality to extend it with <a href="https://jestjs.io/docs/expect#expectextendmatchers" target="_blank" rel="noopener noreferrer">custom matchers</a>.</p><p>In this example we add a custom <code>toBeWithinRange</code> function in the configuration file.</p><p>Now we can use <code>toBeWithinRange</code> in the test.</p><p>For TypeScript, also add the following to <code>global.d.ts</code>. You don&#x27;t need it for JavaScript.</p><p>To import expect matching libraries like <a href="https://github.com/jest-community/jest-extended#installation" target="_blank" rel="noopener noreferrer">jest-extended</a> you can import it from your <code>global.d.ts</code>:</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration-object" class="table-of-contents__link">Configuration object</a><ul><li><a href="#test-suite-options" class="table-of-contents__link">Test suite options</a></li><li><a href="#test-run-options" class="table-of-contents__link">Test run options</a></li></ul></li><li><a href="#workerinfo-object" class="table-of-contents__link">workerInfo object</a></li><li><a href="#testinfo-object" class="table-of-contents__link">testInfo object</a></li><li><a href="#global-setup-and-teardown" class="table-of-contents__link">Global setup and teardown</a></li><li><a href="#projects" class="table-of-contents__link">Projects</a></li><li><a href="#add-custom-matchers-using-expectextend" class="table-of-contents__link">Add custom matchers using expect.extend</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dotnet/docs/intro">Getting started</a></li><li class="footer__item"><a class="footer__link-item" href="/dotnet/docs/api/class-playwright">API reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/playwright" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://aka.ms/playwright-slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/playwrightweb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/microsoft/playwright-sharp" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Microsoft</div></div></div></footer></div>
<script src="/dotnet/assets/js/runtime~main.af00df28.js"></script>
<script src="/dotnet/assets/js/main.8cd6fcf1.js"></script>
</body>
</html>